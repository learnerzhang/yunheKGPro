var p=(h,m,s)=>new Promise((r,i)=>{var l=t=>{try{n(s.next(t))}catch(u){i(u)}},d=t=>{try{n(s.throw(t))}catch(u){i(u)}},n=t=>t.done?r(t.value):Promise.resolve(t.value).then(l,d);n((s=s.apply(h,m)).next())});import{u as q,_ as F}from"./useForm-DGjywljk.js";import"./BasicForm.vue_vue_type_style_index_0_lang-DeNCmJ5N.js";import"./entry/index-CMbP4qrD-1735889696146.js";import{Q as T}from"./antd-DuSlDOy9.js";import{a as k,B as x}from"./index-cSGZvoEm.js";import{u as M}from"./rule-tToMeY1Z.js";import{k as B,i as C}from"./temp-DZeez-6e.js";import{F as L}from"./FormBorder-CKc0r6VT.js";import{d as S,f as g,o as R,c as U,u as a,Z as A,a4 as N,a5 as v,k as _,a9 as O}from"./vue-7EN2lk9e.js";const X=[{title:"接口名称",dataIndex:"name",width:100},{title:"接口地址",dataIndex:"url",width:200},{title:"请求方式",dataIndex:"req_type",width:80},{title:"所属业务",dataIndex:"kgTag_id",width:100},{title:"是否在用",dataIndex:"activate",width:100}],z=[{label:"GET",value:1},{label:"POST",value:0}],G=[{field:"name",label:"接口名称",required:!0,component:"Input",colProps:{span:24}},{field:"url",label:"接口地址",required:!0,component:"Input",colProps:{span:24}},{field:"req_type",label:"请求方式",required:!0,component:"Select",componentProps:{placeholder:"请求方式",options:z},colProps:{span:12}},{field:"business_tag",label:"所属业务",required:!0,slot:"doc_ids",colProps:{span:12}},{field:"activate",label:"是否在用",required:!0,component:"Switch",colProps:{span:12}}],Y=S({__name:"CreateUpdateConditionModal",emits:["success","register"],setup(h,{emit:m}){const s=m,r=g(!0);let i=null;const l=g(""),d=g([]),n=()=>p(this,null,function*(){let e=[];(yield B()).data.map(c=>{e.push({value:c.id,label:c.name})}),d.value=e});R(()=>{n()});const t=U(()=>a(r)?"编辑板块":"新增API"),[u,{resetFields:w,setFieldsValue:V,validate:b}]=q({labelWidth:120,layout:"vertical",rowProps:{gutter:20},baseColProps:{span:24},schemas:G,showActionButtonGroup:!1}),[y,{setModalProps:f,closeModal:P}]=k(e=>p(this,null,function*(){l.value="",w(),f({confirmLoading:!1}),r.value=!!(e!=null&&e.isUpdate),a(r)&&(i=e.record)}));function I(){return p(this,null,function*(){try{let e=yield b();if(f({confirmLoading:!0}),a(r)){const o={zhName:e.zhName,valueType:e.valueType,type:"2"};yield M(o)}else{const o={name:e.name,req_type:e.req_type,url:e.url,activate:e.activate?1:0,business_tag:l.value};i=yield C(o)}P(),s("success")}finally{f({confirmLoading:!1})}})}return(e,o)=>(A(),N(a(x),O(e.$attrs,{onRegister:a(y),showFooter:"",title:t.value,width:"500px",onOk:I}),{default:v(()=>[_(a(F),{onRegister:a(u)},{doc_ids:v(()=>[_(a(L),null,{default:v(()=>[_(a(T),{value:l.value,"onUpdate:value":o[0]||(o[0]=c=>l.value=c),options:d.value,placeholder:"请选择请所属业务"},null,8,["value","options"])]),_:1})]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{Y as _,X as t};
