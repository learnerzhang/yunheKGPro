var f=(l,c,s)=>new Promise((o,r)=>{var m=t=>{try{i(s.next(t))}catch(n){r(n)}},p=t=>{try{i(s.throw(t))}catch(n){r(n)}},i=t=>t.done?o(t.value):Promise.resolve(t.value).then(m,p);i((s=s.apply(l,c)).next())});import{u as y,_ as I}from"./useForm-Hn6EoxrV.js";import"./BasicForm.vue_vue_type_style_index_0_lang-qpF-DMKT.js";import{n as P}from"./antd-DuSlDOy9.js";import{a as F,u as b,c as x}from"./tag-Cz45li_K.js";import{a as M,B as v}from"./index-dXxTZxnK.js";import{d as B,f as R,c as S,u as a,Z as k,a4 as C,a5 as L,k as T,a9 as Y}from"./vue-7EN2lk9e.js";const z=[{title:"标签名称",dataIndex:"name",width:200},{title:"标签描述",dataIndex:"desc",width:200},{title:"标签类目",dataIndex:"tabctt",width:200},{title:"更新时间",dataIndex:"update_time",width:140,customRender:({record:l})=>P(l.update_time).format("YYYY-MM-DD HH:mm")}],A=[{field:"name",label:"标签名称",required:!0,component:"Input",colProps:{span:24}},{field:"type",label:"标签类目",required:!0,component:"ApiSelect",componentProps:{api:F,labelField:"name",valueField:"id",resultField:"data"},colProps:{span:24}},{field:"desc",label:"标签描述",component:"InputTextArea",componentProps:{autoSize:{minRows:2}},colProps:{span:24}}],G=B({__name:"CreateUpdateModal",emits:["success","register"],setup(l,{emit:c}){const s=c,o=R(!0);let r=null;const m=S(()=>a(o)?"编辑标签":"新增标签"),[p,{resetFields:i,setFieldsValue:t,validate:n,updateSchema:g}]=y({labelWidth:90,layout:"vertical",rowProps:{gutter:20},baseColProps:{span:24},schemas:A,showActionButtonGroup:!1}),[h,{setModalProps:u,closeModal:_}]=M(e=>f(this,null,function*(){i(),u({confirmLoading:!1}),o.value=!!(e!=null&&e.isUpdate),a(o)?(r=e.record,t({name:e.record.name,desc:e.record.desc}),g([{field:"type",ifShow:!1}])):e.record.foldId&&t({type:e.record.foldId})}));function w(){return f(this,null,function*(){try{let e=yield n();if(u({confirmLoading:!0}),a(o)){const d={tag_id:r.id,name:e.name,desc:e.desc||""};yield b(d)}else{const d={id:e.type,tags:[e.name],descs:[e.desc||""]};r=yield x(d)}_(),s("success")}finally{u({confirmLoading:!1})}})}return(e,d)=>(k(),C(a(v),Y(e.$attrs,{onRegister:a(h),showFooter:"",title:m.value,width:"500px",onOk:w}),{default:L(()=>[T(a(I),{onRegister:a(p)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{G as _,z as c};
