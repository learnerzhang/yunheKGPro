var g=(h,c,i)=>new Promise((l,e)=>{var u=s=>{try{m(i.next(s))}catch(n){e(n)}},p=s=>{try{m(i.throw(s))}catch(n){e(n)}},m=s=>s.done?l(s.value):Promise.resolve(s.value).then(u,p);m((i=i.apply(h,c)).next())});import{u as B,_ as P}from"./useForm-DGjywljk.js";import"./BasicForm.vue_vue_type_style_index_0_lang-DeNCmJ5N.js";import{a as R,B as S}from"./index-cSGZvoEm.js";import{h as F}from"./graph-Bie93KbO.js";import{d as M,f as k,c as y,u as r,Z as N,a4 as V,a5 as A,$ as C,k as E,a9 as L}from"./vue-7EN2lk9e.js";const q=M({__name:"UpdateEntityModal",emits:["success","register"],setup(h,{emit:c}){const i=c,l=k(!0);let e=null;const u=y(()=>r(l)?"编辑实体":"新增实体"),[p,{resetFields:m,validate:s,appendSchemaByField:n,removeSchemaByField:w}]=B({layout:"vertical",rowProps:{gutter:20},baseColProps:{span:24},schemas:[],showActionButtonGroup:!1}),[b,{setModalProps:d,closeModal:_}]=R(a=>g(this,null,function*(){var o,f;m(),e&&(w("名称"),(o=e==null?void 0:e.attlist)==null||o.map(t=>{w(String(t.id))})),d({confirmLoading:!1}),l.value=!!(a!=null&&a.isUpdate),r(l)&&(e=a.record,n({label:"名称",field:"名称",component:"InputTextArea",defaultValue:e.name,colProps:{span:12},required:!0,componentProps:{autoSize:{minRows:2,maxRows:2}}}),(f=e==null?void 0:e.attlist)==null||f.map(t=>{n({label:t.attname,field:String(t.id),component:"InputTextArea",defaultValue:t.atttvalue,colProps:{span:12},componentProps:{maxlength:1e4,autoSize:{minRows:2,maxRows:2}}})}))}));function v(){return g(this,null,function*(){try{let a=yield s();d({confirmLoading:!0});let o={id:e==null?void 0:e.id,name:a.名称,attrs:[]};Object.keys(a).filter(t=>t!=="名称").forEach(t=>{o.attrs.push({id:Number(t),name:e.attlist.find(x=>x.id==Number(t)).attname,value:a[t]})}),r(l)&&(yield F(o)),_(),i("success")}finally{d({confirmLoading:!1})}})}return(a,o)=>(N(),V(r(S),L(a.$attrs,{onRegister:r(b),showFooter:"",title:u.value,width:"1000px",onOk:v}),{default:A(()=>[o[0]||(o[0]=C("div",{class:"text-base font-bold mb-4"},"实体属性",-1)),E(r(P),{onRegister:r(p)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{q as _};
