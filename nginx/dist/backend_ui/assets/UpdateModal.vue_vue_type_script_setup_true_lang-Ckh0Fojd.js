var p=(s,i,r)=>new Promise((d,o)=>{var c=t=>{try{n(r.next(t))}catch(l){o(l)}},m=t=>{try{n(r.throw(t))}catch(l){o(l)}},n=t=>t.done?d(t.value):Promise.resolve(t.value).then(c,m);n((r=r.apply(s,i)).next())});import{u as x,_ as M}from"./useForm-Hn6EoxrV.js";import"./BasicForm.vue_vue_type_style_index_0_lang-qpF-DMKT.js";import{ab as P,al as b,n as R}from"./antd-DuSlDOy9.js";import{l as g,d as y,f as S,c as k,u as a,Z as v,a4 as B,a5 as F,k as U,a9 as Y}from"./vue-7EN2lk9e.js";import{a as C,B as D}from"./index-dXxTZxnK.js";import{e as L}from"./file-CcanAzse.js";import{ah as T}from"./entry/index-B-McypeI-1739345778478.js";const O=[{title:"文件名称",dataIndex:"title",width:300,ellipsis:!0},{title:"摘要",dataIndex:"desc",width:300,ellipsis:!0},{title:"标签",dataIndex:"tags",width:200,align:"left",customRender:({record:s})=>g(b,{wrap:!0,size:["small","small"],align:"center"},{default:()=>s==null?void 0:s.tag_list.map(i=>g(P,{color:"processing"},i.name))})},{title:"所在目录",dataIndex:"kg_ctt",width:120},{title:"更新时间",dataIndex:"update_time",width:140,customRender:({record:s})=>R(s.update_time).format("YYYY-MM-DD HH:mm")}],z=[{field:"title",label:"文档名称",required:!0,component:"Input",componentProps:{disabled:!0},colProps:{span:24}},{field:"desc",label:"摘要",component:"InputTextArea",componentProps:{autoSize:{minRows:6}},colProps:{span:24}}],W=y({__name:"UpdateModal",emits:["success","register"],setup(s,{emit:i}){const r=T(),d=i,o=S(!0);let c=null;const m=k(()=>(a(o),"编辑摘要")),[n,{resetFields:t,setFieldsValue:l,validate:_}]=x({labelWidth:90,layout:"vertical",rowProps:{gutter:20},baseColProps:{span:24},schemas:z,showActionButtonGroup:!1}),[h,{setModalProps:u,closeModal:w}]=C(e=>p(this,null,function*(){t(),u({confirmLoading:!1}),o.value=!!(e!=null&&e.isUpdate),a(o)&&(c=e.record,l({title:e.record.title,desc:e.record.desc}))}));function I(){return p(this,null,function*(){try{let e=yield _();if(u({confirmLoading:!0}),a(o)){const f={desc:e.desc,doc_id:c.id,user_id:r.getUserInfo.userId};yield L(f)}w(),d("success")}finally{u({confirmLoading:!1})}})}return(e,f)=>(v(),B(a(D),Y(e.$attrs,{onRegister:a(h),showFooter:"",title:m.value,width:"500px",onOk:I}),{default:F(()=>[U(a(M),{onRegister:a(n)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{W as _,O as c};
