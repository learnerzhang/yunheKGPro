var L=Object.defineProperty;var b=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var D=(i,s,t)=>s in i?L(i,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[s]=t,y=(i,s)=>{for(var t in s||(s={}))q.call(s,t)&&D(i,t,s[t]);if(b)for(var t of b(s))A.call(s,t)&&D(i,t,s[t]);return i};var _=(i,s,t)=>new Promise((v,f)=>{var r=d=>{try{m(t.next(d))}catch(c){f(c)}},w=d=>{try{m(t.throw(d))}catch(c){f(c)}},m=d=>d.done?v(d.value):Promise.resolve(d.value).then(r,w);m((t=t.apply(i,s)).next())});import{u as E,_ as O}from"./useTable-BaaQy3Ug.js";import"./TableImg.vue_vue_type_style_index_0_lang-DHdWHvBk.js";import{_ as W}from"./BasicForm.vue_vue_type_style_index_0_lang-DeNCmJ5N.js";import{c as Z,an as g,ao as j}from"./entry/index-CMbP4qrD-1735889696146.js";import{F as x}from"./FormBorder-CKc0r6VT.js";import{g as z,d as J}from"./file-CwdbWB1Z.js";import{P as Q}from"./index-j8d3xuEr.js";import{_ as X}from"./FolderTree.vue_vue_type_style_index_0_lang-DWPZ44SP.js";import{u as ee}from"./index-cSGZvoEm.js";import{c as te,_ as ae}from"./UpdateModal.vue_vue_type_script_setup_true_lang-BMfM8II4.js";import{d as C}from"./download-D9JLiexF.js";import{g as S}from"./task-DgLXztvm.js";import{ae as oe,af as k,R as le,A as se,S as ne}from"./antd-DuSlDOy9.js";import{d as re,f as F,u as e,Z as T,a4 as B,a5 as n,k as l,$ as I,G as h,l as ie,a8 as de}from"./vue-7EN2lk9e.js";import"./useForm-DGjywljk.js";import"./sortable.esm-BEDva30o.js";import"./onMountedOrActivated-8STL9zTa.js";import"./useWindowSizeFn-LSIiJum6.js";import"./index-B2XyhbVp.js";import"./useSortable-Wgj0Awpf.js";import"./index-CUux1OiP.js";import"./copyTextToClipboard-CeRVlT3D.js";import"./useContentViewHeight-psDjuUgH.js";import"./index-CAJtQUpX.js";import"./tag-Tp0Cxjuf.js";const me={class:"w-3/4 xl:w-4/5 p-4"},ue={class:"bg-light-50 p-4 mb-4 h-16"},Ye=re({name:"FileManageComponent",__name:"index",setup(i){const s=Z(),t=F([]),[v,{openModal:f}]=ee();let r=F({keyword:"",cid:void 0,start_time:"",end_time:""});const[w,{reload:m}]=E({title:"文档列表",api:z,rowKey:"id",columns:te,beforeFetch:a=>y(y({},a),e(r)),fetchSetting:{listField:"data"},useSearchForm:!1,showTableSetting:!0,showIndexColumn:!0,bordered:!0,actionColumn:{width:160,title:"操作",dataIndex:"action"}}),d=()=>{t.value?(r.value.start_time=t.value[0],r.value.end_time=t.value[1]):(r.value.start_time="",r.value.end_time=""),m()},c=a=>{r.value.cid=a==0?void 0:a,m()},N=()=>{const{cid:a}=r.value;s(`/file-manage/upload?${a?"cid="+a:""}`)},R=()=>_(this,null,function*(){const a=yield S({type:"图谱"});C({fileName:"图谱模板",url:a.filepath})}),M=()=>_(this,null,function*(){const a=yield S({type:"问答对"});C({fileName:"知识模板",url:a.filepath})}),P=a=>{C({fileName:a.title,url:a.filepath})},$=a=>_(this,null,function*(){yield J({id:a.id}),m()}),U=a=>{const{tag_list:o=[],id:u,title:p,kg_ctt_id:Y,star:G}=a,H=o.map(K=>K.id);f(!0,{record:{id:u,title:p,tagids:H,ctt_id:Y,star:G},isUpdate:!0})},V=()=>{m()};return(a,o)=>(T(),B(e(Q),{dense:"",contentFullHeight:"",fixedHeight:"",contentClass:"flex"},{default:n(()=>[l(X,{class:"w-1/4 xl:w-1/5",onSelect:c}),I("div",me,[I("div",ue,[l(e(g),{type:"primary",onClick:N,class:"mr-4"},{default:n(()=>o[2]||(o[2]=[h(" 文档上传 ")])),_:1}),l(e(g),{onClick:R,class:"mr-4"},{default:n(()=>o[3]||(o[3]=[h(" 图谱模板下载 ")])),_:1}),l(e(g),{onClick:M,class:"mr-4"},{default:n(()=>o[4]||(o[4]=[h(" 知识模板下载 ")])),_:1}),l(e(oe),{layout:"inline",class:"float-right"},{default:n(()=>[l(e(k),null,{default:n(()=>[l(e(x),null,{default:n(()=>[l(e(le),{value:t.value,"onUpdate:value":o[0]||(o[0]=u=>t.value=u),presets:e(j),"value-format":"YYYY-MM-DD",allowClear:""},null,8,["value","presets"])]),_:1})]),_:1}),l(e(k),null,{default:n(()=>[l(e(x),null,{default:n(()=>[l(e(se),{value:e(r).keyword,"onUpdate:value":o[1]||(o[1]=u=>e(r).keyword=u),allowClear:"",placeholder:"搜索标题名称"},null,8,["value"])]),_:1})]),_:1}),l(e(k),null,{default:n(()=>[l(e(g),{type:"primary",onClick:d,icon:ie(e(ne))},{default:n(()=>o[5]||(o[5]=[h("查询")])),_:1},8,["icon"])]),_:1})]),_:1})]),l(e(O),{onRegister:e(w),searchInfo:a.searchInfo},{bodyCell:n(({column:u,record:p})=>[u.key==="action"?(T(),B(e(W),{key:0,actions:[{label:"编辑",onClick:U.bind(null,p)},{label:"下载",onClick:P.bind(null,p)},{label:"删除",color:"error",popConfirm:{title:"是否确认删除",placement:"left",confirm:$.bind(null,p)}}]},null,8,["actions"])):de("",!0)]),_:1},8,["onRegister","searchInfo"])]),l(ae,{onRegister:e(v),onSuccess:V},null,8,["onRegister"])]),_:1}))}});export{Ye as default};
