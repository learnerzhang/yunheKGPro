var T=Object.defineProperty;var b=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var R=(t,n,e)=>n in t?T(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e,_=(t,n)=>{for(var e in n||(n={}))U.call(n,e)&&R(t,e,n[e]);if(b)for(var e of b(n))V.call(n,e)&&R(t,e,n[e]);return t};var v=(t,n,e)=>new Promise((u,c)=>{var g=o=>{try{p(e.next(o))}catch(d){c(d)}},h=o=>{try{p(e.throw(o))}catch(d){c(d)}},p=o=>o.done?u(o.value):Promise.resolve(o.value).then(g,h);p((e=e.apply(t,n)).next())});import{P as j}from"./index-C7IcOeO2.js";import{u as q,_ as A}from"./useTable-BldcMn6n.js";import"./TableImg.vue_vue_type_style_index_0_lang-2oS39uGR.js";import{_ as E}from"./BasicForm.vue_vue_type_style_index_0_lang-qpF-DMKT.js";import{an as k,ao as G}from"./entry/index-B-McypeI-1739345778478.js";import{F as y}from"./FormBorder-BUeDstEP.js";import{j as L,h as O,k as W}from"./rule-oooZlTFW.js";import{n as Z,ah as z,ae as J,af as C,R as K,A as Q,S as X}from"./antd-DuSlDOy9.js";import{l as Y,d as ee,Y as te,f as w,u as a,Z as x,a4 as S,a5 as s,$ as I,k as l,G as M,a8 as ae}from"./vue-7EN2lk9e.js";import{_ as ne}from"./RuleResultModal.vue_vue_type_script_setup_true_lang-CAKCSEuT.js";import{_ as le}from"./RulePreviewModal.vue_vue_type_style_index_0_lang-T60I_75Q.js";import{u as P}from"./index-dXxTZxnK.js";import"./useContentViewHeight-B3Yt78Z4.js";import"./useWindowSizeFn-B30U4ulB.js";import"./onMountedOrActivated-8STL9zTa.js";import"./useForm-Hn6EoxrV.js";import"./sortable.esm-BEDva30o.js";import"./index-BlCAdtVI.js";import"./useSortable-BZ0xEDrO.js";import"./download-CCBYjG8C.js";import"./index-Czo0YvQK.js";import"./copyTextToClipboard-CeRVlT3D.js";import"./index-Duj5iC7n.js";import"./tinycolor-Begke6kS.js";const ie=[{title:"规则名称",dataIndex:"name"},{title:"条件名称",dataIndex:"attrlist"},{title:"规则目标",dataIndex:"actionname",customRender:({record:t})=>t.action},{title:"规则说明",dataIndex:"desc"},{title:"更新时间",dataIndex:"update_time",width:160,customRender:({record:t})=>Z(t.update_time).format("YYYY-MM-DD HH:mm")},{title:"状态",dataIndex:"status",width:120,fixed:"right",customRender:({record:t})=>(Reflect.has(t,"pendingStatus")||(t.pendingStatus=!1),Y(z,{checked:t.status==1,checkedChildren:"",unCheckedChildren:"",loading:t.pendingStatus,onChange(n){t.pendingStatus=!0;const e=n?"1":"0";L({id:t.id,status:e}).then(()=>{t.status=e}).finally(()=>{t.pendingStatus=!1})}}))}],se={class:"p-4"},oe={class:"bg-light-50 p-4 mb-4 h-16"},De=ee({name:"RepertoireManagementComponent",__name:"index",setup(t){const n=te();let e=w({keyword:"",start_time:"",end_time:""});const u=w([]),[c,{openModal:g}]=P(),[h,{openModal:p}]=P(),[o,{reload:d}]=q({title:"规则配置列表",api:O,columns:ie,fetchSetting:{listField:"data"},useSearchForm:!1,showTableSetting:!0,bordered:!0,showIndexColumn:!0,beforeFetch:i=>_(_({},i),a(e)),actionColumn:{width:240,title:"操作",dataIndex:"action",fixed:"right"}});function F(){n.push("/rule-manage/rule-config")}function B(i){n.push({path:"/rule-manage/rule-config",query:{id:i.id,actionId:i.action_id}})}const D=i=>{p(!0,{record:i,isUpdate:!1})};function $(i){return v(this,null,function*(){yield W({id:i.id}),d()})}function H(i){g(!0,{record:i,isUpdate:!1})}const N=()=>v(this,null,function*(){u.value?(e.value.start_time=u.value[0],e.value.end_time=u.value[1]):(e.value.start_time="",e.value.end_time=""),d()});return(i,r)=>(x(),S(a(j),{dense:"",contentFullHeight:"",fixedHeight:""},{default:s(()=>[I("div",se,[I("div",oe,[l(a(k),{type:"primary",onClick:F},{default:s(()=>r[2]||(r[2]=[M(" 新增规则 ")])),_:1}),l(a(J),{layout:"inline",class:"float-right"},{default:s(()=>[l(a(C),null,{default:s(()=>[l(a(y),null,{default:s(()=>[l(a(K),{value:u.value,"onUpdate:value":r[0]||(r[0]=f=>u.value=f),presets:a(G),"value-format":"YYYY-MM-DD",allowClear:""},null,8,["value","presets"])]),_:1})]),_:1}),l(a(C),null,{default:s(()=>[l(a(y),null,{default:s(()=>[l(a(Q),{value:a(e).keyword,"onUpdate:value":r[1]||(r[1]=f=>a(e).keyword=f),allowClear:"",placeholder:"按规则名称检索"},null,8,["value"])]),_:1})]),_:1}),l(a(C),null,{default:s(()=>[l(a(k),{type:"primary",onClick:N,icon:Y(a(X))},{default:s(()=>r[3]||(r[3]=[M("查询")])),_:1},8,["icon"])]),_:1})]),_:1})]),l(a(A),{onRegister:a(o)},{bodyCell:s(({column:f,record:m})=>[f.key==="action"?(x(),S(a(E),{key:0,actions:[{label:"规则分析",onClick:H.bind(null,m)},{label:"预览",onClick:D.bind(null,m)},{label:"编辑",disabled:m.status==1,onClick:B.bind(null,m)},{label:"删除",color:"error",disabled:m.status==1,popConfirm:{title:"是否确认删除",placement:"left",confirm:$.bind(null,m)}}]},null,8,["actions"])):ae("",!0)]),_:1},8,["onRegister"])]),l(ne,{onRegister:a(c)},null,8,["onRegister"]),l(le,{onRegister:a(h)},null,8,["onRegister"])]),_:1}))}});export{De as default};
