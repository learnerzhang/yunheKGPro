var x=(L,C,m)=>new Promise((y,b)=>{var _=u=>{try{o(m.next(u))}catch(r){b(r)}},g=u=>{try{o(m.throw(u))}catch(r){b(r)}},o=u=>u.done?y(u.value):Promise.resolve(u.value).then(_,g);o((m=m.apply(L,C)).next())});import{i as E}from"./rule-oooZlTFW.js";import{P as J}from"./index-C7IcOeO2.js";import{c as M,an as h,X as Q}from"./entry/index-B-McypeI-1739345778478.js";import{F as v}from"./FormBorder-BUeDstEP.js";import{d as W,f as n,Y as z,u as e,o as X,Z as w,a4 as D,a5 as t,$ as c,k as l,G as T,_ as V,F as Y,a7 as Z,a0 as K,a3 as ee,a8 as ae}from"./vue-7EN2lk9e.js";import{z as le,A as te}from"./temp-BXVrim_O.js";import{ae as se,af as d,V as U,U as p,A as oe,Q as j,ag as B,a9 as ne,j as F}from"./antd-DuSlDOy9.js";import"./useContentViewHeight-B3Yt78Z4.js";import"./useWindowSizeFn-B30U4ulB.js";import"./onMountedOrActivated-8STL9zTa.js";const ue={class:"bg-light-50 p-12 pl-20 pr-20 pb-30 flex-1 overflow-y-auto"},re={class:"flex"},ie={class:"flex"},de={class:"w-100%"},pe=["onClick"],fe={class:"text-center absolute bottom-0 right-0 left-0 w-full py-8 border-t-1 border-gray-200 z-10 bg-light-50"},ce=W({name:"TempUploadComponent",__name:"index",setup(L){n({display:"flex"});const C=M(),{currentRoute:m}=z(),y=z(),b=e(m),_=n([{value:0,label:"雨水实况"},{value:1,label:"河道水情"},{value:2,label:"工情险情实况"}]),g=n([]);let o=n({name:"",description:"",plateList:[]}),u=n([{info:"",desc:"",mk:"",fj:""},{info:"",desc:"",mk:"",fj:""},{info:"",desc:"",mk:"",fj:""}]);const r=n(0),A=(i,a)=>{r.value=a};X(()=>{$()});const I=n(null),N=n(""),S=n([]);n([]);const k=n({});n(null);const O=i=>{S.value.map(a=>{a.value===i&&(N.value=a.label)})},G=i=>{const a=[];i.length>0&&(_.value.map(s=>{i.map(f=>{s.value==f&&a.push(s.label)})}),g.value=a)},H=(i="publish")=>x(this,null,function*(){const{action_id:a,name:s,desc:f}=o.value;if(!a){F.error("请选择规则目标");return}if(!s){F.error("请填写规则名称");return}I.value.consoleTree(),k.value||F.error("请配置规则内容"),yield E({rule_id:b.query.id||void 0,name:s,desc:f||"",content:k.value?k.value:{},action_id:a||"",status:i==="publish"?1:0}),y.push({path:"/rule-manage/rule"})}),P=()=>{C("/temp-manage/page")},R=n([]),$=()=>x(this,null,function*(){const i=yield le();R.value=i.data,R.value.map(a=>{a.label=a.desc,a.value=a.code})}),q=()=>x(this,null,function*(){yield te({})});return(i,a)=>(w(),D(e(J),{contentFullHeight:"",contentClass:"flex"},{default:t(()=>[c("div",ue,[l(e(se),{layout:"vertical"},{default:t(()=>[l(e(d),null,{default:t(()=>[c("div",re,[a[7]||(a[7]=c("div",{class:"w-80 font-bold text-lg label-name"},"模板基本信息",-1)),l(e(U),{gutter:20,class:"flex-1"},{default:t(()=>[l(e(p),{span:12},{default:t(()=>[l(e(d),{label:"系统模板名称"},{default:t(()=>[l(e(v),null,{default:t(()=>[l(e(oe),{value:e(o).name,"onUpdate:value":a[0]||(a[0]=s=>e(o).name=s),placeholder:"请输入系统模板名称"},null,8,["value"])]),_:1})]),_:1})]),_:1}),l(e(p),{span:12},{default:t(()=>[l(e(d),{label:"业务类型"},{default:t(()=>[l(e(v),null,{default:t(()=>[l(e(j),{value:e(o).action_id,"onUpdate:value":a[1]||(a[1]=s=>e(o).action_id=s),options:R.value,onChange:O,placeholder:"请选择业务类型"},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),l(e(p),{span:12},{default:t(()=>[l(e(d),{label:"模板配置"},{default:t(()=>[l(e(v),null,{default:t(()=>[l(e(j),{value:e(o).plateList,"onUpdate:value":a[2]||(a[2]=s=>e(o).plateList=s),mode:"multiple",options:_.value,onChange:G,placeholder:"请选择模板配置",allowClear:"",showArrow:""},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),l(e(p),{span:12},{default:t(()=>[l(e(d),{label:"模板描述"},{default:t(()=>[l(e(v),null,{default:t(()=>[l(e(B),{value:e(o).description,"onUpdate:value":a[3]||(a[3]=s=>e(o).description=s),"auto-size":{minRows:2,maxRows:5},placeholder:"请输入模板描述"},null,8,["value"])]),_:1})]),_:1})]),_:1}),l(e(p),{span:24},{default:t(()=>[l(e(h),{type:"default",class:"w-30 float-right",onClick:q},{default:t(()=>a[6]||(a[6]=[T("确认")])),_:1})]),_:1})]),_:1})])]),_:1}),l(e(ne),{class:"mb-10"}),l(e(d),null,{default:t(()=>[c("div",ie,[a[8]||(a[8]=c("div",{class:"w-80 font-bold text-lg label-name"},"模板配置信息",-1)),c("div",de,[l(e(U),{gutter:20,class:"flex-1"},{default:t(()=>[l(e(p),{span:24,class:"mb-20px"},{default:t(()=>[(w(!0),V(Y,null,Z(g.value,(s,f)=>(w(),V("div",{class:K(["inline-block mr-20px btn-box cursor-pointer",r.value==f?"btn-active":""]),onClick:me=>A(s,f),key:f},ee(s),11,pe))),128))]),_:1})]),_:1}),r.value!==null?(w(),D(e(U),{key:0,gutter:20,class:"flex-1"},{default:t(()=>[l(e(p),{span:12},{default:t(()=>[l(e(d),{label:"关键信息"},{default:t(()=>[l(e(v),null,{default:t(()=>[l(e(B),{value:e(u)[r.value].info,"onUpdate:value":a[4]||(a[4]=s=>e(u)[r.value].info=s),"auto-size":{minRows:2,maxRows:5},placeholder:"请输入关键信息"},null,8,["value"])]),_:1})]),_:1})]),_:1}),l(e(p),{span:12},{default:t(()=>[l(e(d),{label:"参考描述"},{default:t(()=>[l(e(v),null,{default:t(()=>[l(e(B),{value:e(u)[r.value].desc,"onUpdate:value":a[5]||(a[5]=s=>e(u)[r.value].desc=s),"auto-size":{minRows:2,maxRows:5},placeholder:"请输入参考描述"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})):ae("",!0)])])]),_:1})]),_:1}),c("div",fe,[l(e(h),{type:"default",class:"mr-4 w-30",onClick:P},{default:t(()=>a[9]||(a[9]=[T("取消")])),_:1}),l(e(h),{type:"default",class:"w-30",onClick:H},{default:t(()=>a[10]||(a[10]=[T("确认")])),_:1})])])]),_:1}))}}),Te=Q(ce,[["__scopeId","data-v-dbabec09"]]);export{Te as default};
