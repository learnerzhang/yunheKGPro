var g=(h,R,m)=>new Promise((C,y)=>{var i=r=>{try{_(m.next(r))}catch(b){y(b)}},n=r=>{try{_(m.throw(r))}catch(b){y(b)}},_=r=>r.done?C(r.value):Promise.resolve(r.value).then(i,n);_((m=m.apply(h,R)).next())});import{h as G,g as H,e as $,i as j}from"./rule-tToMeY1Z.js";import{P as E}from"./index-j8d3xuEr.js";import{c as M,an as B,X as Q}from"./entry/index-CMbP4qrD-1735889696146.js";import{F as p}from"./FormBorder-CKc0r6VT.js";import{d as W,f,Y as F,u as e,o as X,Z as I,a4 as Y,a5 as t,$ as v,k as l,ad as Z,G as D,_ as K,F as ee,a7 as ae,a0 as le,a3 as te}from"./vue-7EN2lk9e.js";import{f as oe,ae as ne,af as u,V as N,U as d,A as se,Q as T,aJ as ue,aL as de,ag as x,a9 as ie,j as U}from"./antd-DuSlDOy9.js";import"./useContentViewHeight-psDjuUgH.js";import"./useWindowSizeFn-LSIiJum6.js";import"./onMountedOrActivated-8STL9zTa.js";const re={class:"bg-light-50 p-12 pl-20 pr-20 pb-30 flex-1 overflow-y-auto"},pe={class:"flex"},fe={class:"flex"},ce=["onClick"],ve={class:"text-center absolute bottom-0 right-0 left-0 w-full py-8 border-t-1 border-gray-200 z-10 bg-light-50"},me=W({name:"TempUploadComponent",__name:"index",setup(h){const R=f({display:"flex"}),m=M(),{currentRoute:C}=F(),y=F(),i=e(C);let n=f({rule_id:i.query.id||void 0,action_id:void 0,name:"",desc:"",create_time:""});const _=f(0),r=(s,a)=>{_.value=a},b=()=>g(this,null,function*(){const{id:s}=i.query,a=(yield $({id:s}))||{};n.value={rule_id:i.query.id||void 0,action_id:(a==null?void 0:a.action_id)||void 0,name:(a==null?void 0:a.name)||"",desc:(a==null?void 0:a.desc)||""},P.value=a!=null&&a.content?JSON.parse(a==null?void 0:a.content):null});X(()=>g(this,null,function*(){yield V(),i.query.id&&b()}));const A=f(null),S=f(""),c=f([]),q=f([]),z=f({}),P=f(null),V=()=>g(this,null,function*(){const s=yield G({page:1,pageSize:1e4});q.value=s.data.map(a=>a.action_id),yield J()}),k=s=>{c.value.map(a=>{a.value===s&&(S.value=a.label)})},J=()=>g(this,null,function*(){var a;const s=yield H({type:1,page:1,pageSize:1e4});c.value=oe(((a=s==null?void 0:s.data)==null?void 0:a.map(o=>({label:o.zhName,value:o.id})))||[]),c.value=c.value.filter(o=>!q.value.includes(o.value)),i.query&&i.query.id&&s.data.map(o=>{o.id==i.query.actionId&&(S.value=o.zhName,c.value.push({value:o.id,label:o.zhName}))})}),L=(s="publish")=>g(this,null,function*(){const{action_id:a,name:o,desc:w}=n.value;if(!a){U.error("请选择规则目标");return}if(!o){U.error("请填写规则名称");return}A.value.consoleTree(),z.value||U.error("请配置规则内容"),yield j({rule_id:i.query.id||void 0,name:o,desc:w||"",content:z.value?z.value:{},action_id:a||"",status:s==="publish"?1:0}),y.push({path:"/rule-manage/rule"})}),O=()=>{m("/rule-manage/rule")};return(s,a)=>(I(),Y(e(E),{contentFullHeight:"",contentClass:"flex"},{default:t(()=>[v("div",re,[l(e(ne),{layout:"vertical"},{default:t(()=>[l(e(u),null,{default:t(()=>[v("div",pe,[a[10]||(a[10]=v("div",{class:"w-80 font-bold text-lg label-name"},"板块基本信息",-1)),l(e(N),{gutter:20,class:"flex-1"},{default:t(()=>[l(e(d),{span:12},{default:t(()=>[l(e(u),{label:"板块名称"},{default:t(()=>[l(e(p),null,{default:t(()=>[l(e(se),{value:e(n).name,"onUpdate:value":a[0]||(a[0]=o=>e(n).name=o),placeholder:"请输入规则名称"},null,8,["value"])]),_:1})]),_:1})]),_:1}),l(e(d),{span:12},{default:t(()=>[l(e(u),{label:"业务类型"},{default:t(()=>[l(e(p),null,{default:t(()=>[l(e(T),{value:e(n).action_id,"onUpdate:value":a[1]||(a[1]=o=>e(n).action_id=o),options:c.value,onChange:k,placeholder:"请选择业务类型"},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),l(e(d),{span:12},{default:t(()=>[l(e(u),{label:"创建时间"},{default:t(()=>[l(e(p),null,{default:t(()=>[l(e(ue),{class:"w-full","show-time":"",placeholder:"请选择日期和时间",value:e(n).create_time,"onUpdate:value":a[2]||(a[2]=o=>e(n).create_time=o)},null,8,["value"])]),_:1})]),_:1})]),_:1}),l(e(d),{span:12},{default:t(()=>[l(e(u),{label:"创建人"},{default:t(()=>[l(e(de),{style:Z(R.value),value:1},{default:t(()=>a[9]||(a[9]=[D("admin")])),_:1},8,["style"])]),_:1})]),_:1}),l(e(d),{span:12},{default:t(()=>[l(e(u),{label:"板块配置"},{default:t(()=>[l(e(p),null,{default:t(()=>[l(e(T),{value:e(n).action_id,"onUpdate:value":a[3]||(a[3]=o=>e(n).action_id=o),mode:"multiple",options:c.value,onChange:k,placeholder:"请选择业务类型",allowClear:"",showArrow:""},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),l(e(d),{span:12},{default:t(()=>[l(e(u),{label:"板块描述"},{default:t(()=>[l(e(p),null,{default:t(()=>[l(e(x),{value:e(n).desc,"onUpdate:value":a[4]||(a[4]=o=>e(n).desc=o),"auto-size":{minRows:2,maxRows:5},placeholder:"请输入规则说明"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1}),l(e(ie),{class:"mb-10"}),l(e(u),null,{default:t(()=>[v("div",fe,[a[11]||(a[11]=v("div",{class:"w-80 font-bold text-lg label-name"},"板块配置信息",-1)),l(e(N),{gutter:20,class:"flex-1"},{default:t(()=>[l(e(d),{span:24,class:"mb-20px"},{default:t(()=>[(I(),K(ee,null,ae(["雨水实况","河道水情","工情险情实况"],(o,w)=>v("div",{class:le(["inline-block mr-20px btn-box cursor-pointer",_.value==w?"btn-active":""]),onClick:_e=>r(o,w),key:w},te(o),11,ce)),64))]),_:1}),l(e(d),{span:12},{default:t(()=>[l(e(u),{label:"关键信息"},{default:t(()=>[l(e(p),null,{default:t(()=>[l(e(x),{value:e(n).desc,"onUpdate:value":a[5]||(a[5]=o=>e(n).desc=o),"auto-size":{minRows:2,maxRows:5},placeholder:"请输入关键信息"},null,8,["value"])]),_:1})]),_:1})]),_:1}),l(e(d),{span:12},{default:t(()=>[l(e(u),{label:"参考描述"},{default:t(()=>[l(e(p),null,{default:t(()=>[l(e(x),{value:e(n).desc,"onUpdate:value":a[6]||(a[6]=o=>e(n).desc=o),"auto-size":{minRows:2,maxRows:5},placeholder:"请输入参考描述"},null,8,["value"])]),_:1})]),_:1})]),_:1}),l(e(d),{span:12},{default:t(()=>[l(e(u),{label:"关键模块"},{default:t(()=>[l(e(p),null,{default:t(()=>[l(e(T),{value:e(n).action_id,"onUpdate:value":a[7]||(a[7]=o=>e(n).action_id=o),mode:"multiple",options:c.value,onChange:k,placeholder:"请选择业务类型",allowClear:"",showArrow:""},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),l(e(d),{span:12},{default:t(()=>[l(e(u),{label:"附加信息"},{default:t(()=>[l(e(p),null,{default:t(()=>[l(e(x),{value:e(n).desc,"onUpdate:value":a[8]||(a[8]=o=>e(n).desc=o),"auto-size":{minRows:2,maxRows:5},placeholder:"请输入附加信息"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),v("div",ve,[l(e(B),{type:"default",class:"mr-4 w-30",onClick:O},{default:t(()=>a[12]||(a[12]=[D("取消")])),_:1}),l(e(B),{type:"default",class:"w-30",onClick:L},{default:t(()=>a[13]||(a[13]=[D("确认")])),_:1})])])]),_:1}))}}),Te=Q(me,[["__scopeId","data-v-7fee89e7"]]);export{Te as default};
