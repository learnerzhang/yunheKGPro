var oe=Object.defineProperty,ue=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var B=(c,o,u)=>o in c?oe(c,o,{enumerable:!0,configurable:!0,writable:!0,value:u}):c[o]=u,R=(c,o)=>{for(var u in o||(o={}))ie.call(o,u)&&B(c,u,o[u]);if(z)for(var u of z(o))pe.call(o,u)&&B(c,u,o[u]);return c},L=(c,o)=>ue(c,re(o));var g=(c,o,u)=>new Promise((b,w)=>{var p=_=>{try{V(u.next(_))}catch(k){w(k)}},h=_=>{try{V(u.throw(_))}catch(k){w(k)}},V=_=>_.done?b(_.value):Promise.resolve(_.value).then(p,h);V((u=u.apply(c,o)).next())});import{c as ce,an as D,X as fe}from"./entry/index-CMbP4qrD-1735889696146.js";import{a as me,t as ve,c as _e,e as ye,f as ge,k as xe,h as be}from"./temp-DZeez-6e.js";import{P as he}from"./index-j8d3xuEr.js";import{F as C}from"./FormBorder-CKc0r6VT.js";import{d as Ve,Y as J,u as l,f as r,o as ke,a6 as I,Z as j,a4 as G,a5 as t,$ as m,k as a,a3 as K,G as T,a8 as Ce}from"./vue-7EN2lk9e.js";import{J as H}from"./index-1zamOp_T.js";import{ae as we,af as v,V as M,U as x,A as Ue,Q,ag as qe,ah as De}from"./antd-DuSlDOy9.js";import"./useContentViewHeight-psDjuUgH.js";import"./useWindowSizeFn-LSIiJum6.js";import"./onMountedOrActivated-8STL9zTa.js";const Ie={class:"bg-light-50 p-12 pl-20 pr-20 pb-30 flex-1 overflow-y-auto"},Te={class:"flex"},Re={class:"overflow-y-scroll h-200px"},Ee={class:"overflow-y-scroll h-200px"},Se={class:"text-center flex justify-end w-full mr-10px mt-20px z-10"},Ae={class:"flex"},Ne={class:"h-300px overflow-y-scroll p-10px"},Pe={class:"h-300px overflow-y-scroll p-10px"},Oe={class:"text-center flex justify-end w-full py-8 border-t-1 border-gray-200 z-10 bg-light-50"},Fe=Ve({name:"TempUploadComponent",__name:"interfaceEdit",setup(c){const o=ce(),{currentRoute:u}=J();J();const b=l(u);r(!1);const w=r({}),p=r([{id:1,name:"",type:"",value:"",desc:""}]),h=r([{id:1,name:"",type:"",value:"",desc:""}]),V=r([]),_=s=>{let e={};return s.map(d=>{d.name&&(d.type==0?e[d.name]=Number(d.value):e[d.name]=d.value)}),e},k=r([{label:"string",value:"1"},{label:"number",value:"0"}]),E=s=>s==="1"?"string":s==="0"?"number":"",U=r(!1),W=s=>{p.value.length>0&&p.value.map(e=>{e.name&&(U.value=!0)})},S=({row:s},e)=>{if(e=="table"){const d=p.value.length-1;p.value.indexOf(s)===d&&A(s)&&N(e)}else{const d=h.value.length-1;h.value.indexOf(s)===d&&A(s)&&N(e)}},A=s=>{const e=["name","type"];for(let d of e)if(!s[d])return!1;return!0},N=s=>{s=="table"?p.value.push({id:p.value.length-1,name:"",type:"",value:"",desc:""}):h.value.push({id:h.value.length-1,name:"",type:"",value:"",desc:""})};let f=r({name:"",url:"",req_type:0,kgTag_id:""});const q=r(!1),X=()=>g(this,null,function*(){const{id:s}=b.query,{data:e}=(yield me({id:s}))||{};f.value={name:(e==null?void 0:e.name)||"",url:(e==null?void 0:e.url)||"",req_type:e==null?void 0:e.req_type,kgTag_id:(e==null?void 0:e.kgTag_id)||""},q.value=(e==null?void 0:e.activate)!=0}),Y=()=>g(this,null,function*(){Z();let s=_(p.value),e=_(h.value);const d=L(R({activate:0},f.value),{params:JSON.stringify(s),headers:JSON.stringify(e)});q.value?d.activate=1:d.activate=0;const y=yield ve(d);w.value=y}),Z=()=>g(this,null,function*(){const s=yield _e({data_model_id:b.query.id});V.value=s}),$=()=>g(this,null,function*(){let s={mid:b.query.id,name:"",type:"",desc:"",default:""};p.value.length>0&&p.value.map(e=>g(this,null,function*(){try{if(s.name=e.name,s.type=e.type,s.desc=e.desc,e.type=="number"?s.default=Number(e.value):s.default=e.value,!e.name)return;const d=yield ye(s);U.value=!1}catch(d){d.response.data.code==201&&(U.value=!1)}}))}),ee=()=>g(this,null,function*(){const s=yield ge({id:b.query.id});let e=[];s.data.length>0&&(s.data.map((d,y)=>{e.push({id:y+1,name:d.name,type:d.type,value:d.default,desc:d.desc})}),p.value=e)}),ae=()=>g(this,null,function*(){let s=[];(yield xe()).data.map(d=>{s.push({value:d.id,label:d.name})}),P.value=s});ke(()=>g(this,null,function*(){b.query.id&&(X(),ae(),ee())})),r(null),r("");const le=r([{value:0,label:"POST"},{value:1,label:"GET"}]),P=r([]);r([]),r({}),r(null);const te=s=>{},ne=s=>{},se=()=>{o("/dataAccess/page")},de=()=>g(this,null,function*(){const s=R({id:b.query.id,activate:0},f.value);q.value?s.activate=1:s.activate=0,yield be(s),o("/dataAccess/page")});return(s,e)=>{const d=I("vxe-column"),y=I("vxe-input"),O=I("vxe-select"),F=I("vxe-table");return j(),G(l(he),{contentFullHeight:"",fixedHeight:"",contentClass:"flex"},{default:t(()=>[m("div",Ie,[a(l(we),{layout:"vertical"},{default:t(()=>[a(l(v),null,{default:t(()=>[m("div",Te,[a(l(M),{gutter:20,class:"flex-1"},{default:t(()=>[a(l(x),{span:12},{default:t(()=>[a(l(v),{label:"接口名称"},{default:t(()=>[a(l(C),null,{default:t(()=>[a(l(Ue),{value:l(f).name,"onUpdate:value":e[0]||(e[0]=n=>l(f).name=n),placeholder:"请输入接口名称"},null,8,["value"])]),_:1})]),_:1})]),_:1}),a(l(x),{span:12},{default:t(()=>[a(l(v),{label:"请求方式"},{default:t(()=>[a(l(C),null,{default:t(()=>[a(l(Q),{value:l(f).req_type,"onUpdate:value":e[1]||(e[1]=n=>l(f).req_type=n),options:le.value,onChange:te,placeholder:"请选择请求方式"},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),a(l(x),{span:12},{default:t(()=>[a(l(v),{label:"API地址"},{default:t(()=>[a(l(C),null,{default:t(()=>[a(l(qe),{value:l(f).url,"onUpdate:value":e[2]||(e[2]=n=>l(f).url=n),"auto-size":{minRows:1,maxRows:5},placeholder:"请输入接口地址"},null,8,["value"])]),_:1})]),_:1})]),_:1}),a(l(x),{span:12},{default:t(()=>[a(l(v),{label:"是否在用"},{default:t(()=>[a(l(De),{checked:q.value,"onUpdate:checked":e[3]||(e[3]=n=>q.value=n)},null,8,["checked"])]),_:1})]),_:1}),a(l(x),{span:12,class:"mr-25px"},{default:t(()=>[a(l(v),{label:"所属业务"},{default:t(()=>[a(l(C),null,{default:t(()=>[a(l(Q),{value:l(f).kgTag_id,"onUpdate:value":e[4]||(e[4]=n=>l(f).kgTag_id=n),options:P.value,onChange:ne,placeholder:"请选择请求方式"},null,8,["value","options"])]),_:1})]),_:1})]),_:1}),a(l(x),{span:12},{default:t(()=>[a(l(v),{label:"请求参数"},{default:t(()=>[m("div",Re,[a(F,{border:"","show-overflow":"",data:p.value,"column-config":{resizable:!0},"keyboard-config":{isEnter:!0,isEsc:!0},"edit-config":{trigger:"click",mode:"row",showIcon:!1},onCellClick:e[5]||(e[5]=n=>S(n,"table")),onEditClosed:W},{default:t(()=>[a(d,{type:"seq",width:"60"}),a(d,{field:"name",title:"参数名称","edit-render":{}},{edit:t(({row:n})=>[a(y,{modelValue:n.name,"onUpdate:modelValue":i=>n.name=i,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(d,{field:"type",title:"参数类型","edit-render":{}},{default:t(({row:n})=>[m("span",null,K(E(n.type)),1)]),edit:t(({row:n})=>[a(O,{modelValue:n.type,"onUpdate:modelValue":i=>n.type=i,type:"text",options:k.value,transfer:""},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1}),a(d,{field:"value",title:"参数值","edit-render":{}},{edit:t(({row:n})=>[a(y,{modelValue:n.value,"onUpdate:modelValue":i=>n.value=i,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(d,{field:"desc",title:"描述","edit-render":{}},{edit:t(({row:n})=>[a(y,{modelValue:n.desc,"onUpdate:modelValue":i=>n.desc=i,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])])]),_:1})]),_:1}),a(l(x),{span:12},{default:t(()=>[a(l(v),{label:"请求头参数"},{default:t(()=>[m("div",Ee,[a(F,{border:"","show-overflow":"",data:h.value,"column-config":{resizable:!0},"keyboard-config":{isEnter:!0,isEsc:!0},"edit-config":{trigger:"click",mode:"row",showIcon:!1},onCellClick:e[6]||(e[6]=n=>S(n,"tableSec"))},{default:t(()=>[a(d,{type:"seq",width:"60"}),a(d,{field:"name",title:"参数名称","edit-render":{}},{edit:t(({row:n})=>[a(y,{modelValue:n.name,"onUpdate:modelValue":i=>n.name=i,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(d,{field:"type",title:"参数类型","edit-render":{}},{default:t(({row:n})=>[m("span",null,K(E(n.type)),1)]),edit:t(({row:n})=>[a(O,{modelValue:n.type,"onUpdate:modelValue":i=>n.type=i,type:"text",options:k.value,transfer:""},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1}),a(d,{field:"value",title:"参数值","edit-render":{}},{edit:t(({row:n})=>[a(y,{modelValue:n.value,"onUpdate:modelValue":i=>n.value=i,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(d,{field:"desc",title:"描述","edit-render":{}},{edit:t(({row:n})=>[a(y,{modelValue:n.desc,"onUpdate:modelValue":i=>n.desc=i,type:"text"},null,8,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data"])])]),_:1})]),_:1}),m("div",Se,[U.value?(j(),G(l(D),{key:0,type:"primary",class:"w-25 mr-20px",onClick:$},{default:t(()=>e[7]||(e[7]=[T("新增参数")])),_:1})):Ce("",!0),a(l(D),{type:"primary",class:"w-25",disabled:U.value,onClick:Y},{default:t(()=>e[8]||(e[8]=[T("测试")])),_:1},8,["disabled"])])]),_:1})])]),_:1}),a(l(v),null,{default:t(()=>[m("div",Ae,[a(l(M),{gutter:20,class:"flex-1"},{default:t(()=>[a(l(x),{span:12},{default:t(()=>[a(l(v),{label:"请求详情"},{default:t(()=>[a(l(C),null,{default:t(()=>[m("div",Ne,[a(l(H),{data:V.value},null,8,["data"])])]),_:1})]),_:1})]),_:1}),a(l(x),{span:12},{default:t(()=>[a(l(v),{label:"返回结果"},{default:t(()=>[a(l(C),null,{default:t(()=>[m("div",Pe,[a(l(H),{data:w.value},null,8,["data"])])]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1}),m("div",Oe,[a(l(D),{type:"default",class:"w-25 mr-4",onClick:se},{default:t(()=>e[9]||(e[9]=[T("取消")])),_:1}),a(l(D),{type:"primary",class:"w-25",onClick:de},{default:t(()=>e[10]||(e[10]=[T("确认")])),_:1})])])]),_:1})}}}),Xe=fe(Fe,[["__scopeId","data-v-b9ea6b8d"]]);export{Xe as default};
