import{C as _,_ as h,u as V,r as I,a as M,o as P,b as l,c as U,d as K,e as a,f as s,w as o,g as b,s as D,E as j}from"./index-1e331aa6.js";import{r as B}from"./index-b1f89694.js";const S=`MIIBVAIBADANBgkqhkiG9w0BAQEFAASCAT4wggE6AgEAAkEAqhHyZfSsYourNxaY
7Nt+PrgrxkiA50efORdI5U5lsW79MmFnusUA355oaSXcLhu5xxB38SMSyP2KvuKN
PuH3owIDAQABAkAfoiLyL+Z4lf4Myxk6xUDgLaWGximj20CUf+5BKKnlrK+Ed8gA
kM0HqoTt2UZwA5E2MzS4EI2gjfQhz5X28uqxAiEA3wNFxfrCZlSZHb0gn2zDpWow
cSxQAgiCstxGUoOqlW8CIQDDOerGKH5OmCJ4Z21v+F25WaHYPxCFMvwxpcw99Ecv
DQIgIdhDTIqD2jfYjPTY8Jj3EDGPbH2HHuffvflECt3Ek60CIQCFRlCkHpi7hthh
YhovyloRYsM+IS9h/0BzlEAuO0ktMQIgSPT3aFAgJYwKpqRYKlLDVcflZFCKY7u3
UP8iWi1Qw0Y=`,F=d=>{const m=S;return _.AES.encrypt(d,m).toString()},Y=d=>{const m=S;return _.AES.decrypt(d,m).toString(_.enc.Utf8)},q=d=>B.post({url:"userapp/userapi/login",data:d});const H={class:"login"},N={class:"main"},R={class:"center"},Q={class:"content"},T={class:"flex"},J={class:"flex items-center w-100% justify-end"},O="25r0d12g4h2gj4hhju7s5gh5j6nm",Z={__name:"login",setup(d){const m=V(),y=I(),v={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}]},f=I(!1),t=M({username:"",password:"",systemId:"2"}),x=r=>JSON.stringify(r),A=r=>{const e=x(r);return _.AES.encrypt(e,O).toString()},k=()=>{y.value.validate(async r=>{if(r){if(f.value){localStorage.setItem("username",t.username);const p=F(t.password);localStorage.setItem("encryptedPassword",p),localStorage.setItem("rememberMe","true")}else localStorage.removeItem("username"),localStorage.removeItem("encryptedPassword"),localStorage.setItem("rememberMe","false");const e={username:t.username,password:t.password},n=await q(e),{id:c,username:w}=n;localStorage.setItem("userInfo",JSON.stringify(n));let g=A({userId:c,username:w});if(t.systemId==="1"){if(c){const p=`http://192.168.2.182:5000?token=${encodeURIComponent(g)}`;window.location.href=p}}else t.systemId==="2"?(D(n.username),m.push({path:"/smart"})):m.push({path:"/login"})}else return j.error("表单验证失败，请检查输入"),!1})};return P(()=>{const r=localStorage.getItem("username"),e=localStorage.getItem("rememberMe"),n=localStorage.getItem("encryptedPassword");if(e==="true"){if(t.username=r||"",n){const c=Y(n);t.password=c}f.value=!0}}),(r,e)=>{const n=l("el-icon"),c=l("el-option"),w=l("el-select"),i=l("el-form-item"),g=l("el-input"),p=l("el-checkbox"),E=l("el-button"),C=l("el-form");return U(),K("div",H,[a("div",N,[a("div",R,[e[8]||(e[8]=a("div",{class:"title"},null,-1)),a("div",Q,[s(C,{model:t,rules:v,ref_key:"loginFormRef",ref:y},{default:o(()=>[s(i,{label:"",prop:"systemId"},{default:o(()=>[s(w,{modelValue:t.systemId,"onUpdate:modelValue":e[0]||(e[0]=u=>t.systemId=u),class:"select",size:"default",filterable:!1},{prefix:o(()=>[a("span",T,[s(n,{class:"el-icon-change"})])]),default:o(()=>[s(c,{label:"知识库门户",value:"2"}),s(c,{label:"知识管理平台",value:"1"})]),_:1},8,["modelValue"])]),_:1}),s(i,{label:"",prop:"username"},{default:o(()=>[s(g,{modelValue:t.username,"onUpdate:modelValue":e[1]||(e[1]=u=>t.username=u),placeholder:"请输入用户名",class:"input"},{prefix:o(()=>[s(n,{class:"el-icon-user"})]),_:1},8,["modelValue"])]),_:1}),s(i,{label:"",prop:"password"},{default:o(()=>[s(g,{modelValue:t.password,"onUpdate:modelValue":e[2]||(e[2]=u=>t.password=u),placeholder:"请输入密码",type:"password",class:"input","show-password":""},{prefix:o(()=>[s(n,{class:"el-icon-pass"})]),_:1},8,["modelValue"])]),_:1}),s(i,{label:""},{default:o(()=>[a("div",J,[s(p,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=u=>f.value=u),disabled:!1},{default:o(()=>e[4]||(e[4]=[b("记住密码")])),_:1},8,["modelValue"]),e[5]||(e[5]=a("span",{class:"checkbox-item"},null,-1)),e[6]||(e[6]=a("span",{class:"text-#fff"},"忘记密码",-1))])]),_:1}),s(i,{label:"",prop:""},{default:o(()=>[s(E,{class:"btnLogin",type:"primary",onClick:k},{default:o(()=>e[7]||(e[7]=[b("登录")])),_:1})]),_:1})]),_:1},8,["model"])])])])])}}},z=h(Z,[["__scopeId","data-v-a3b16e34"]]);export{z as default};
