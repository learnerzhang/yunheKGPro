import{C as _,_ as V,u as M,r as I,a as P,o as U,b as a,c as K,d as D,e as d,f as t,w as o,g as b,s as j,E as S}from"./index-49801a30.js";import{r as B}from"./index-60adf17b.js";const v=`MIIBVAIBADANBgkqhkiG9w0BAQEFAASCAT4wggE6AgEAAkEAqhHyZfSsYourNxaY
7Nt+PrgrxkiA50efORdI5U5lsW79MmFnusUA355oaSXcLhu5xxB38SMSyP2KvuKN
PuH3owIDAQABAkAfoiLyL+Z4lf4Myxk6xUDgLaWGximj20CUf+5BKKnlrK+Ed8gA
kM0HqoTt2UZwA5E2MzS4EI2gjfQhz5X28uqxAiEA3wNFxfrCZlSZHb0gn2zDpWow
cSxQAgiCstxGUoOqlW8CIQDDOerGKH5OmCJ4Z21v+F25WaHYPxCFMvwxpcw99Ecv
DQIgIdhDTIqD2jfYjPTY8Jj3EDGPbH2HHuffvflECt3Ek60CIQCFRlCkHpi7hthh
YhovyloRYsM+IS9h/0BzlEAuO0ktMQIgSPT3aFAgJYwKpqRYKlLDVcflZFCKY7u3
UP8iWi1Qw0Y=`,F=u=>{const m=v;return _.AES.encrypt(u,m).toString()},Y=u=>{const m=v;return _.AES.decrypt(u,m).toString(_.enc.Utf8)},q=u=>B.postOriginal({url:"userapp/userapi/login",data:u});const H={class:"login"},N={class:"main"},R={class:"center"},Q={class:"content"},T={class:"flex"},O={class:"flex items-center w-100% justify-end"},J="25r0d12g4h2gj4hhju7s5gh5j6nm",Z={__name:"login",setup(u){const m=M(),y=I(),x={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}]},p=I(!1),s=P({username:"",password:"",systemId:"0"}),A=r=>JSON.stringify(r),k=r=>{const e=A(r);return _.AES.encrypt(e,J).toString()},E=()=>{y.value.validate(async r=>{if(r){if(p.value){localStorage.setItem("username",s.username);const l=F(s.password);localStorage.setItem("encryptedPassword",l),localStorage.setItem("rememberMe","true")}else localStorage.removeItem("username"),localStorage.removeItem("encryptedPassword"),localStorage.setItem("rememberMe","false");const e={username:s.username,password:s.password,type:s.systemId},n=await q(e),{id:i,username:f}=n.data;if(n.code==200){localStorage.setItem("userInfo",JSON.stringify(n.data));let g=k({userId:i,username:f});if(s.systemId==="1"){const w=`http://192.168.2.182:5000?token=${encodeURIComponent(g)}`;window.location.href=w}else s.systemId=="0"?(j(f),m.push({path:"/smart"})):m.push({path:"/login"})}else S.error("您无权限访问该系统")}else return S.error("表单验证失败，请检查输入"),!1})};return U(()=>{const r=localStorage.getItem("username"),e=localStorage.getItem("rememberMe"),n=localStorage.getItem("encryptedPassword");if(e==="true"){if(s.username=r||"",n){const i=Y(n);s.password=i}p.value=!0}}),(r,e)=>{const n=a("el-icon"),i=a("el-option"),f=a("el-select"),l=a("el-form-item"),g=a("el-input"),w=a("el-checkbox"),C=a("el-button"),h=a("el-form");return K(),D("div",H,[d("div",N,[d("div",R,[e[8]||(e[8]=d("div",{class:"title"},null,-1)),d("div",Q,[t(h,{model:s,rules:x,ref_key:"loginFormRef",ref:y},{default:o(()=>[t(l,{label:"",prop:"systemId"},{default:o(()=>[t(f,{modelValue:s.systemId,"onUpdate:modelValue":e[0]||(e[0]=c=>s.systemId=c),class:"select",size:"default",filterable:!1},{prefix:o(()=>[d("span",T,[t(n,{class:"el-icon-change"})])]),default:o(()=>[t(i,{label:"知识库门户",value:"0"}),t(i,{label:"知识管理平台",value:"1"})]),_:1},8,["modelValue"])]),_:1}),t(l,{label:"",prop:"username"},{default:o(()=>[t(g,{modelValue:s.username,"onUpdate:modelValue":e[1]||(e[1]=c=>s.username=c),placeholder:"请输入用户名",class:"input"},{prefix:o(()=>[t(n,{class:"el-icon-user"})]),_:1},8,["modelValue"])]),_:1}),t(l,{label:"",prop:"password"},{default:o(()=>[t(g,{modelValue:s.password,"onUpdate:modelValue":e[2]||(e[2]=c=>s.password=c),placeholder:"请输入密码",type:"password",class:"input","show-password":""},{prefix:o(()=>[t(n,{class:"el-icon-pass"})]),_:1},8,["modelValue"])]),_:1}),t(l,{label:""},{default:o(()=>[d("div",O,[t(w,{modelValue:p.value,"onUpdate:modelValue":e[3]||(e[3]=c=>p.value=c),disabled:!1},{default:o(()=>e[4]||(e[4]=[b("记住密码")])),_:1},8,["modelValue"]),e[5]||(e[5]=d("span",{class:"checkbox-item"},null,-1)),e[6]||(e[6]=d("span",{class:"text-#fff"},"忘记密码",-1))])]),_:1}),t(l,{label:"",prop:""},{default:o(()=>[t(C,{class:"btnLogin",type:"primary",onClick:E},{default:o(()=>e[7]||(e[7]=[b("登录")])),_:1})]),_:1})]),_:1},8,["model"])])])])])}}},z=V(Z,[["__scopeId","data-v-2b00ea96"]]);export{z as default};
