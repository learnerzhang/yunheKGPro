import{C as _,_ as h,u as V,r as I,a as M,o as P,b as l,c as U,d as K,e as a,f as s,w as o,g as b,s as D,E as j}from"./index-e8810ffd.js";import{r as B}from"./index-273f287e.js";const S=`MIIBVAIBADANBgkqhkiG9w0BAQEFAASCAT4wggE6AgEAAkEAqhHyZfSsYourNxaY
7Nt+PrgrxkiA50efORdI5U5lsW79MmFnusUA355oaSXcLhu5xxB38SMSyP2KvuKN
PuH3owIDAQABAkAfoiLyL+Z4lf4Myxk6xUDgLaWGximj20CUf+5BKKnlrK+Ed8gA
kM0HqoTt2UZwA5E2MzS4EI2gjfQhz5X28uqxAiEA3wNFxfrCZlSZHb0gn2zDpWow
cSxQAgiCstxGUoOqlW8CIQDDOerGKH5OmCJ4Z21v+F25WaHYPxCFMvwxpcw99Ecv
DQIgIdhDTIqD2jfYjPTY8Jj3EDGPbH2HHuffvflECt3Ek60CIQCFRlCkHpi7hthh
YhovyloRYsM+IS9h/0BzlEAuO0ktMQIgSPT3aFAgJYwKpqRYKlLDVcflZFCKY7u3
UP8iWi1Qw0Y=`,F=d=>{const u=S;return _.AES.encrypt(d,u).toString()},Y=d=>{const u=S;return _.AES.decrypt(d,u).toString(_.enc.Utf8)},q=d=>B.post({url:"userapp/userapi/login",data:d});const H={class:"login"},N={class:"main"},R={class:"center"},Q={class:"content"},T={class:"flex"},J={class:"flex items-center w-100% justify-end"},O="25r0d12g4h2gj4hhju7s5gh5j6nm",Z={__name:"login",setup(d){const u=V(),y=I(),x={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}]},f=I(!1),t=M({username:"",password:"",systemId:"2"}),v=n=>JSON.stringify(n),A=n=>{const e=v(n);return _.AES.encrypt(e,O).toString()},k=()=>{y.value.validate(async n=>{if(n){if(f.value){localStorage.setItem("username",t.username);const p=F(t.password);localStorage.setItem("encryptedPassword",p),localStorage.setItem("rememberMe","true")}else localStorage.removeItem("username"),localStorage.removeItem("encryptedPassword"),localStorage.setItem("rememberMe","false");const e={username:t.username,password:t.password},r=await q(e),{id:m,username:w}=r;localStorage.setItem("userInfo",JSON.stringify(r));let g=A({userId:m,username:w});if(t.systemId==="1"){const p=`http://192.168.2.182:5000?token=${encodeURIComponent(g)}`;window.location.href=p}else t.systemId==="2"?(D(r.username),u.push({path:"/smart"})):u.push({path:"/login"})}else return j.error("表单验证失败，请检查输入"),!1})};return P(()=>{const n=localStorage.getItem("username"),e=localStorage.getItem("rememberMe"),r=localStorage.getItem("encryptedPassword");if(e==="true"){if(t.username=n||"",r){const m=Y(r);t.password=m}f.value=!0}}),(n,e)=>{const r=l("el-icon"),m=l("el-option"),w=l("el-select"),i=l("el-form-item"),g=l("el-input"),p=l("el-checkbox"),E=l("el-button"),C=l("el-form");return U(),K("div",H,[a("div",N,[a("div",R,[e[8]||(e[8]=a("div",{class:"title"},null,-1)),a("div",Q,[s(C,{model:t,rules:x,ref_key:"loginFormRef",ref:y},{default:o(()=>[s(i,{label:"",prop:"systemId"},{default:o(()=>[s(w,{modelValue:t.systemId,"onUpdate:modelValue":e[0]||(e[0]=c=>t.systemId=c),class:"select",filterable:"",size:"default"},{prefix:o(()=>[a("span",T,[s(r,{class:"el-icon-change"})])]),default:o(()=>[s(m,{label:"知识管理平台",value:"1"}),s(m,{label:"知识库门户",value:"2"})]),_:1},8,["modelValue"])]),_:1}),s(i,{label:"",prop:"username"},{default:o(()=>[s(g,{modelValue:t.username,"onUpdate:modelValue":e[1]||(e[1]=c=>t.username=c),placeholder:"请输入用户名",class:"input"},{prefix:o(()=>[s(r,{class:"el-icon-user"})]),_:1},8,["modelValue"])]),_:1}),s(i,{label:"",prop:"password"},{default:o(()=>[s(g,{modelValue:t.password,"onUpdate:modelValue":e[2]||(e[2]=c=>t.password=c),placeholder:"请输入密码",type:"password",class:"input","show-password":""},{prefix:o(()=>[s(r,{class:"el-icon-pass"})]),_:1},8,["modelValue"])]),_:1}),s(i,{label:""},{default:o(()=>[a("div",J,[s(p,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=c=>f.value=c),disabled:!1},{default:o(()=>e[4]||(e[4]=[b("记住密码")])),_:1},8,["modelValue"]),e[5]||(e[5]=a("span",{class:"checkbox-item"},null,-1)),e[6]||(e[6]=a("span",{class:"text-#fff"},"忘记密码",-1))])]),_:1}),s(i,{label:"",prop:""},{default:o(()=>[s(E,{class:"btnLogin",type:"primary",onClick:k},{default:o(()=>e[7]||(e[7]=[b("登录")])),_:1})]),_:1})]),_:1},8,["model"])])])])])}}},z=h(Z,[["__scopeId","data-v-ba2193c9"]]);export{z as default};
